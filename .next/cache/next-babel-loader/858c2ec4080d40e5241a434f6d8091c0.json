{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport React, { useEffect } from \"react\";\nimport axios from \"axios\";\nimport styled from 'styled-components';\nimport { MainLayout } from '../components/MainLayout';\nimport { actionGetPosts } from \"../redux/actions/actions\";\nimport PostContainer from '../components/postContainer';\nimport StyledLoader from \"../components/loader\";\nimport StyledButton from \"../components/button\";\nvar GlobalContainer = styled.div.withConfig({\n  displayName: \"pages__GlobalContainer\",\n  componentId: \"dznqvx-0\"\n})([\"margin:0 auto;max-width:1040px;width:100%\"]);\nvar LoaderContainer = styled.div.withConfig({\n  displayName: \"pages__LoaderContainer\",\n  componentId: \"dznqvx-1\"\n})([\"width:100%;display:flex;justify-content:center;\"]);\nvar PostsContainer = styled.div.withConfig({\n  displayName: \"pages__PostsContainer\",\n  componentId: \"dznqvx-2\"\n})([\"position:relative;display:flex;flex-wrap:wrap;margin:0 -20px;\"]);\nexport default function Posts(_ref) {\n  var InitialPosts = _ref.InitialPosts;\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.posts;\n  }),\n      posts = _useSelector.posts;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.app;\n  }),\n      loading = _useSelector2.loading;\n\n  var _useSelector3 = useSelector(function (state) {\n    return state.posts;\n  }),\n      limit = _useSelector3.limit;\n\n  var loadMore = function loadMore() {\n    function load_SPA_data() {\n      return _load_SPA_data.apply(this, arguments);\n    }\n\n    function _load_SPA_data() {\n      _load_SPA_data = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (limit === 6) {\n                  dispatch(actionGetPosts(12));\n                } else {\n                  dispatch(actionGetPosts(limit));\n                }\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _load_SPA_data.apply(this, arguments);\n    }\n\n    load_SPA_data();\n  };\n\n  useEffect(function () {\n    function load_SPA_data() {\n      return _load_SPA_data2.apply(this, arguments);\n    }\n\n    function _load_SPA_data2() {\n      _load_SPA_data2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                dispatch(actionGetPosts(limit));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n      return _load_SPA_data2.apply(this, arguments);\n    }\n\n    if (!InitialPosts) {\n      load_SPA_data();\n    }\n  }, []);\n\n  var getPostsForRender = function getPostsForRender(arr) {\n    return arr.map(function (post, index) {\n      if (index === 0 || index % 6 === 0) {\n        // @ts-ignore\n        return /*#__PURE__*/_jsx(PostContainer, {\n          size: \"large\",\n          post: post\n        }, post.id);\n      } else {\n        // @ts-ignore\n        return /*#__PURE__*/_jsx(PostContainer, {\n          size: \"small\",\n          post: post\n        }, post.id);\n      }\n    });\n  };\n\n  var renderPosts = function renderPosts() {\n    if (InitialPosts && !posts.length) {\n      return getPostsForRender(InitialPosts);\n    } else {\n      return getPostsForRender(posts);\n    }\n  };\n\n  return /*#__PURE__*/_jsx(MainLayout, {\n    title: 'Home Page',\n    children: /*#__PURE__*/_jsxs(GlobalContainer, {\n      children: [/*#__PURE__*/_jsx(PostsContainer, {\n        children: renderPosts()\n      }), loading ? /*#__PURE__*/_jsx(LoaderContainer, {\n        children: /*#__PURE__*/_jsx(StyledLoader, {})\n      }) : /*#__PURE__*/_jsx(StyledButton, {\n        type: \"submit\",\n        text: \"Load More\",\n        func: loadMore\n      })]\n    })\n  });\n}\n\nPosts.getServerSideProps = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref2) {\n    var req, data, InitialPosts;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            req = _ref2.req;\n\n            if (req) {\n              _context3.next = 3;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", {\n              InitialPosts: null\n            });\n\n          case 3:\n            _context3.next = 5;\n            return axios.get(\"https://simple-blog-api.crew.red/posts?_limit=6\");\n\n          case 5:\n            data = _context3.sent;\n            InitialPosts = data.data;\n            return _context3.abrupt(\"return\", {\n              InitialPosts: InitialPosts\n            });\n\n          case 8:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n\n  return function (_x) {\n    return _ref3.apply(this, arguments);\n  };\n}();","map":null,"metadata":{},"sourceType":"module"}